# Design Tip #168 What’s in a Name?

一見すると些細なことのようですが、「名前」はとても重要です。特に、データウェアハウス／BI（DW/BI）システムをアドホックに利用するユーザーにとっては、テーブルやカラムの良い名前が不可欠です。これらのオブジェクトを探し出すときに役立つからです。オブジェクト名は技術者向けではなく、ビジネスユーザーを意識して付けるべきです。

可能な限り、DW/BI システム上の名前はセマンティックレイヤーでも変更されず、レポート設計者にも変更されないようにすべきです。さらに難しいことに、ユーザーがデータを自分の PC に取り込んだ後でオブジェクト名を変えないように抑制する必要があります。これを完全に防ぐことはできませんが、魅力的で分かりやすい名前にしておけば、名前を変えたいと思う気持ちを減らせます。

以下に、データウェアハウス／BI システムにおけるオブジェクト命名の私のベスト 10 提案を示します。

## 1. 命名規則に従うこと

もしまだ命名規則がないなら、この設計ヒントのルールに従った規則を作り（そして文書化し）ましょう。

すでに規則がある場合、多くは技術者のために作られているはずです。しかし、DW/BI 環境では命名はビジネスユーザー向けであるべきです。これらの名前はアドホック分析や定型レポート内で「行名・列名」として直接現れるのです。

## 2. オブジェクトには一つの名前しか認めない

組織内で既に存在するデータ定義の混乱を招いてはなりません。同じカラムのことを、営業部が「Geography」、マーケティング部が「Region」と呼ぶようなことは許されません。中身が同じカラムなら、名前も一つでなければなりません。組織全体で合意が取れない場合には、ビジネススポンサーに仲裁を依頼しましょう。

## 3. オブジェクト名は説明的であること

その名前の意味を理解するために 20 年勤続するような必要があってはいけません。たとえば RBVLSPCD のような無意味な短縮（いまや 8 文字制限などないのです！）は禁止されます。同様に NAME のようなカラム名も禁止です。テーブル名との関連が外れた場合に意味が通じないためです。

## 4. 略語と頭字語は極力避ける

略語や頭字語は企業内に蔓延していますし、非企業の世界ではさらにひどい場合もあります。確かに略語には多くの情報が詰め込まれていますが、新しい人には大きな負担になります。効果的なのは「承認済み略語リスト」を維持することです。そして、正当な理由がなければ新しい略語を追加しないことです。理由を文書化しておくのもよいでしょう。

多くの組織にとって、妥当な「承認済み略語リスト」は数十個程度であり、数百個ではありません。

## 5. オブジェクト名は「見た目が良い」こと

オブジェクト名はレポートや分析の見出しにもなります。「見た目が良い」は主観的なものですが、個人的にはすべて大文字の名前は特にうっとうしいと感じます。単語の区切りが視覚的に分かるようにすべきです。

- スペース区切り: [Column Name]
- キャメルケース: ColumnName
- アンダースコア: Column_Name または COLUMN_NAME

私はスペースを推奨します。レポートに表示されたときに最も見栄えがよいからです。開発者が「角括弧をタイプしなければならない」という反論は的外れです。SQL を書く開発者ならどのキーが角括弧なのかすぐに分かりますし、指の筋肉も十分に発達させられるはずです。

## 6. オブジェクト名は一意であること

これは「一つのオブジェクトには一つの名前」というルールの裏返しです。異なるオブジェクトには異なる名前を付けるべきです。

例えば `City` というカラムは不適切です。代わりに `Customer Mailing Address City` のようにすべきです。これは特にアドホック利用をする場合に重要です。なぜなら、分析時には文脈で分かっていても、その分析結果が保存・共有されたときには文脈が失われる事があるからです。顧客の居住地なのか、店舗の所在地なのか、郵送先か配送先か？これらが分からなくなります。

ユーザーが Excel に出力した後で名前を変えることは避けられませんが、こちらからユーザーに改名を強いることは避けるべきです。

## 7. オブジェクト名は長すぎないこと

このルールは 3・4・6 と矛盾する可能性があります。一意で、省略せず、説明的にすると、必然的に長い名前になってしまうからです。

たとえば `Mandatory Second Payer Letter Opt Out Code` や `Vocational Provider Referral Category` のように。保険業界では意味が明確でも、これをレポートに入れると列見出しが極端に折り返されるか、読めないほど小さい文字になります。そうするとユーザーがカラム名を改名してしまい、「一つのオブジェクトは一つの名前」というルールに反してしまいます。

私はカラム名を 30 文字以内（最長でも 35 文字）に収めるようにしています。そのために本来なら避けたい略語や頭字語を登録せざるを得ないこともあります。

## 8. 必要に応じてテーブル略称をカラム名の先頭に付ける

この方法は略語や短縮名を避けるという私自身のルールに反してしまうので気は進まないのですが、一貫性と一意性を保証するために、最近は用いる頻度が増えてきています。

9. 必要であればビュー層で名前を変更する

私たちは常に、物理テーブルの上にビュー層を設け、そのビューに対して全クエリを実行することを推奨してきました。ビューを用いる主目的は、BI アプリケーションと物理 DB の間に絶縁層を設け、本番運用中でもスムーズに変更を受け入れられる柔軟性を確保するためです。加えて、このビュー層は、ビジネス向けの名前をデータベース内に実装する場所にもなります。

物理テーブル・カラムを最初からビジネス寄りの名前にすることを常に第一に推奨します。どうしてもできない場合にビュー層で変更するのです。BI ツール内で名前を変更することは好ましくありません。理由は以下の通りです。

- 多くの組織では複数の BI ツールを使っています。名前がツールごとに違ってはいけません。
- ビジネスロジックをツールに埋め込みすぎると、ツール移行が極めて困難になります。
- 名前が BI ツールだけに存在する場合、利用者・フロントのサポート・バックエンドの DB 担当の間での共通理解を妨げます。

10. 一貫性を保つ！

「愚かな一貫性」は小さな心の悪魔と言われたりしますが、命名における一貫性はユーザーにとって計り知れないほど価値があります。

[Design Tip #168 What’s in a Name?](https://www.kimballgroup.com/2014/07/design-tip-168-whats-name/)
